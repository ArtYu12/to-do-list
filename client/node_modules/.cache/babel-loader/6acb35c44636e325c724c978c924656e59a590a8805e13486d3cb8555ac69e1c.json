{"ast":null,"code":"import _regeneratorRuntime from\"C:/Dev/react/project1/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Dev/react/project1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Dev/react/project1/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Dev/react/project1/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{profileAPI}from'./../components/api/api';import{stopSubmit}from'redux-form';var ADD_POST='ADD-POST';var UPDATE_NEW_POST_TEXT='UPDATE-NEW-POST-TEXT';var SET_USER_PROFILE='SET_USER_PROFILE';var SET_STATUS='SET_STATUS';var DELETE_POST='DELETE_POST';var SAVE_PHOTO_SUCCESS='SAVE_PHOTO_SUCCESS';var SET_ERROR='SET_ERROR';var initialState={posts:[{'id':'1','message':'Hi,how are you?','likesCount':22},{'id':'2','message':'It\\'s my first post','likesCount':15}],profile:null,status:\"\",error:''};var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ADD_POST:{var newPost={'id':5,'message':action.post,'likesCount':0};return _objectSpread(_objectSpread({},state),{},{posts:[].concat(_toConsumableArray(state.posts),[newPost])});}case UPDATE_NEW_POST_TEXT:{return _objectSpread(_objectSpread({},state),{},{newPostText:action.newText});}case SET_USER_PROFILE:{return _objectSpread(_objectSpread({},state),{},{profile:action.profile});}case SET_STATUS:{return _objectSpread(_objectSpread({},state),{},{status:action.status});}case DELETE_POST:{return _objectSpread(_objectSpread({},state),{},{posts:state.posts.filter(function(p){return p.id!=action.postId;})});}case SAVE_PHOTO_SUCCESS:{return _objectSpread(_objectSpread({},state),{},{profile:_objectSpread(_objectSpread({},state.profile),{},{photos:action.photos})});}case SET_ERROR:{return _objectSpread(_objectSpread({},state),{},{error:action.error});}default:{return state;}}};export var addPostActionCreater=function addPostActionCreater(post){return{type:ADD_POST,post:post};};export var setUserProfile=function setUserProfile(profile){return{type:SET_USER_PROFILE,profile:profile};};export var updateNewPostTextActionCreater=function updateNewPostTextActionCreater(text){return{type:UPDATE_NEW_POST_TEXT,newText:text};};export var setStatus=function setStatus(status){return{type:SET_STATUS,status:status};};export var deletePost=function deletePost(postId){return{type:DELETE_POST,postId:postId};};export var savePhotoSuccess=function savePhotoSuccess(photos){return{type:SAVE_PHOTO_SUCCESS,photos:photos};};var setError=function setError(error){return{type:SET_ERROR,error:error};};export var getProfile=function getProfile(profileId){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return profileAPI.getProfile(profileId);case 2:response=_context.sent;dispatch(setUserProfile(response.data));case 4:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getStatus=function getStatus(profileId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return profileAPI.getStatus(profileId);case 2:response=_context2.sent;dispatch(setStatus(response.data));case 4:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var updateStatus=function updateStatus(status){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return profileAPI.updateStatus(status);case 3:response=_context3.sent;if(response.data.resultCode===0){dispatch(setStatus(status));}_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);dispatch(setError(_context3.t0.messages[0]));case 10:case\"end\":return _context3.stop();}},_callee3,null,[[0,7]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var savePhoto=function savePhoto(file){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return profileAPI.savePhoto(file);case 2:response=_context4.sent;if(response.data.resultCode===0){dispatch(savePhotoSuccess(response.data.data.photos));}case 4:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var saveProfile=function saveProfile(profile){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch,getState){var userId,response;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:userId=getState().auth.userId;_context5.next=3;return profileAPI.saveProfile(profile);case 3:response=_context5.sent;if(!(response.data.resultCode===0)){_context5.next=8;break;}dispatch(getProfile(userId));_context5.next=10;break;case 8:dispatch(stopSubmit('edit-profile',{_error:response.data.messages[0]}));return _context5.abrupt(\"return\",Promise.reject(response.data.messages[0]));case 10:case\"end\":return _context5.stop();}},_callee5);}));return function(_x5,_x6){return _ref5.apply(this,arguments);};}();};export default profileReducer;","map":{"version":3,"names":["profileAPI","stopSubmit","ADD_POST","UPDATE_NEW_POST_TEXT","SET_USER_PROFILE","SET_STATUS","DELETE_POST","SAVE_PHOTO_SUCCESS","SET_ERROR","initialState","posts","profile","status","error","profileReducer","state","action","type","newPost","post","newPostText","newText","filter","p","id","postId","photos","addPostActionCreater","setUserProfile","updateNewPostTextActionCreater","text","setStatus","deletePost","savePhotoSuccess","setError","getProfile","profileId","dispatch","response","data","getStatus","updateStatus","resultCode","messages","savePhoto","file","saveProfile","getState","userId","auth","_error","Promise","reject"],"sources":["C:/Dev/react/project1/src/redux/profile-reducer.js"],"sourcesContent":["import {profileAPI} from './../components/api/api';\r\nimport {stopSubmit} from 'redux-form'\r\n\r\nconst ADD_POST = 'ADD-POST'\r\nconst UPDATE_NEW_POST_TEXT = 'UPDATE-NEW-POST-TEXT'\r\nconst SET_USER_PROFILE  = 'SET_USER_PROFILE'\r\nconst SET_STATUS  = 'SET_STATUS'\r\nconst DELETE_POST = 'DELETE_POST'\r\nconst SAVE_PHOTO_SUCCESS = 'SAVE_PHOTO_SUCCESS'\r\nconst SET_ERROR = 'SET_ERROR'\r\n\r\n\r\nlet initialState = {\r\n  posts: [\r\n      {'id':'1', 'message':'Hi,how are you?', 'likesCount': 22},\r\n      {'id':'2', 'message':'It\\'s my first post', 'likesCount': 15}\r\n    ],\r\n  profile:null,\r\n  status:\"\",\r\n  error:''\r\n}\r\n\r\nconst profileReducer = (state = initialState,action) =>{\r\n    switch(action.type){\r\n   \r\n    case ADD_POST: {\r\n        let newPost = {\r\n          'id': 5, \r\n          'message':action.post,\r\n          'likesCount': 0\r\n        };\r\n        return {\r\n            ...state,\r\n            posts: [...state.posts, newPost]\r\n        }\r\n      }\r\n    case UPDATE_NEW_POST_TEXT:{\r\n        return {\r\n          ...state,\r\n          newPostText:action.newText\r\n        }\r\n    }\r\n    case SET_USER_PROFILE:{\r\n      return {\r\n        ...state,\r\n        profile:action.profile\r\n      }\r\n    }\r\n    case SET_STATUS:{\r\n      return {\r\n        ...state,\r\n        status:action.status\r\n      }\r\n    }\r\n    case DELETE_POST:{\r\n      return {\r\n        ...state,\r\n        posts:state.posts.filter(p => p.id != action.postId)\r\n      }\r\n    }\r\n    case SAVE_PHOTO_SUCCESS:{\r\n      return {\r\n        ...state,\r\n        profile: {...state.profile , photos:action.photos}\r\n      }\r\n    }\r\n    case SET_ERROR : {\r\n      return {\r\n        ...state,\r\n        error:action.error\r\n      }\r\n    }\r\n    default: {\r\n        return state;\r\n    }\r\n  }\r\n}\r\n\r\nexport const addPostActionCreater = (post) => ({type:ADD_POST,post});\r\nexport const setUserProfile  = (profile) => ({type:SET_USER_PROFILE,profile});\r\nexport const updateNewPostTextActionCreater = (text) =>({ type:UPDATE_NEW_POST_TEXT, newText:text });\r\nexport const setStatus = (status) => ({ type:SET_STATUS, status:status });\r\nexport const deletePost = (postId) => ({ type:DELETE_POST,postId});\r\nexport const savePhotoSuccess = (photos) => ({ type:SAVE_PHOTO_SUCCESS,photos});\r\nconst setError = (error) => ({type:SET_ERROR,error});\r\n\r\nexport const getProfile = (profileId) => async (dispatch) => {\r\n    let response = await profileAPI.getProfile(profileId)\r\n      dispatch(setUserProfile(response.data));\r\n    }\r\nexport const getStatus = (profileId) => async (dispatch) => {\r\n    let response = await profileAPI.getStatus(profileId)\r\n        dispatch(setStatus(response.data));\r\n}\r\nexport const updateStatus = (status) => async (dispatch) => {\r\n    try {\r\n      let response = await profileAPI.updateStatus(status)\r\n      if(response.data.resultCode === 0) {\r\n        dispatch(setStatus(status));\r\n      }\r\n    } catch(error) {\r\n      dispatch(setError(error.messages[0]));\r\n    }\r\n  }\r\nexport const savePhoto = (file) => async (dispatch) => {\r\n  let response = await profileAPI.savePhoto(file)\r\n      if(response.data.resultCode === 0) {\r\n        dispatch(savePhotoSuccess(response.data.data.photos));\r\n      }\r\n  }\r\nexport const saveProfile = (profile) => async (dispatch,getState) => {\r\n  const userId = getState().auth.userId\r\n  let response = await profileAPI.saveProfile(profile)\r\n      if(response.data.resultCode === 0) {\r\n       dispatch(getProfile(userId));\r\n      } else {\r\n        dispatch(stopSubmit('edit-profile',{_error:response.data.messages[0]}))\r\n        return Promise.reject(response.data.messages[0])\r\n      }\r\n  }\r\nexport default profileReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}